# Copyright (C) 2019 NETSCOUT SYSTEMS, INC. All Rights Reserved.
# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/TA_netscout_aed/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/TA_netscout_aed/default
# into ../local and edit there.

[syslog_headers]
# device_hostname - AED or APS device hostname
# syslog_format - Common Event Format (CEF) OR Log Event Encoded Format (LEEF); legacy format not supported
# syslog_format_version
# device_vendor - NETSCOUT
# device_product - Arbor Edge Defense OR Arbor Networks APS
# device_product_version - AED or APS device version 6.2+ supported
# device_event_class_id - alert type that generated the notification
# alert_type - name of alert sub-type; excluded with LEEF syslog format
# severity - severity level for the AIF rule that matched traffic; excluded with LEEF syslog format in syslog_headers
# msg - except for blocked host notifications, human-readable message description
REGEX = (?<device_hostname>\b\S+(?=\s\w{3,4}:\d))\s+(?<syslog_format>\b(CEF|LEEF)\b)\:(?<syslog_format_version>\d+|\d+\.\d+)\|(?<device_vendor>\bNETSCOUT\b)\|(?<device_product>\w+\s+\w+\s+\w+)\|(?<device_product_version>[^\|]+)\|(?<device_event_class_id>[^\|]+)(\|(?<alert_type>[^\|]+)\|(?<severity>\d{1,2}))?\|(?<msg>(rt=|msg=).+)$

[rt]
# timestamp in EPOCH format; start of line in msg
SOURCE_KEY = msg
REGEX = ^rt=(?<rt>\d+)

[severity]
# severity level for the AIF rule that matched traffic; excluded with CEF syslog format in msg
SOURCE_KEY = msg
REGEX = sev=(?<severity>\d{1,2})

[src]
# source IP address (IPv4 | IPv6)
SOURCE_KEY = msg
REGEX = src=(?<src>(?:(?:\d{1,3}\.){3}(?:\d{1,3}))|(?:(?:::)?(?:[\dA-Fa-f]{1,4}:{1,2}){1,7}(?:[\d\%A-Fa-z\.]+)?(?:::)?)|(?:::[\dA-Fa-f\.]{1,15})|(?:::))

[dpt]
# destination port number; LEEF - dpt; CEF - dstPort
SOURCE_KEY = msg
REGEX = \b(dpt|dstPort)\b=(?<dpt>\d{1,5})

[proto]
# protocol 
SOURCE_KEY = msg
REGEX = proto=(?<proto>\b\w+\b)

[dst]
# destination IP address (IPv4 | IPv6)
SOURCE_KEY = msg
REGEX = dst=(?<dst>(?:(?:\d{1,3}\.){3}(?:\d{1,3}))|(?:(?:::)?(?:[\dA-Fa-f]{1,4}:{1,2}){1,7}(?:[\d\%A-Fa-z\.]+)?(?:::)?)|(?:::[\dA-Fa-f\.]{1,15})|(?:::))

[spt]
# source port number; CEF - spt; LEEF - srcPort
SOURCE_KEY = msg
REGEX = \b(spt|srcPort)\b=(?<spt>\d+)

# cn1Label=Element Id

[element_id]
# Identifier of the matching AIF rule; AIF rule matches only
SOURCE_KEY = msg
REGEX = cn1=(?<element_id>\d+)

# cn2Label=Protection Group ID

[pg_id]
# AED/APS Protection Group ID
SOURCE_KEY = msg
REGEX = cn2=(?<pg_id>\d+)

# cs1Label=IOC Pattern

[ioc_pattern]
# The IP address, domain name, or URL that matched a rule; AIF or STIX rule matches only
SOURCE_KEY = msg
REGEX = cs1=(?<ioc_pattern>\S+)

# cs2Label=Protection Group Name

[pg_name]
# AED/APS Protection Group Name; end of line in msg
SOURCE_KEY = msg
REGEX = cs2=(?<pg_name>\b.+)$

# cs3Label=Match Type

[match_type]
# Pattern type that was matched (ip, dns, or url); AIF or STIX rule matches only
SOURCE_KEY = msg
REGEX = cs3=(?<match_type>\b(ip|dns|url)\b)

# cs4Label=TAXII Collection ID

[taxii_collection_id]
# Identifier of the TAXII collection containing the matched pattern; STIX rule matches only
SOURCE_KEY = msg
REGEX = cs4=(?<taxii_collection_id>\S+)

# cs5Label=TAXII Collection Title

[taxii_collection_title]
# Name of the TAXII collection containing the matched pattern; STIX rule matches only
SOURCE_KEY = msg
REGEX = cs5=(?<taxii_collection_title>\b.+(?=\scs4=))

# cs6Label=Threat Name

[threat_name]
# AIF threat name; AIF rule matches only
SOURCE_KEY = msg
REGEX = cs6=(?<threat_name>\b\w.+(?=\scs1=))

# cs7Label=Threat Category

[threat_category]
# AIF threat category; AIF rule matches only; field added with AED v6.3
SOURCE_KEY = msg
REGEX = cs7=(?<threat_category>\b\w.+(?=\scs6=))

[message]
# message from msg
SOURCE_KEY = msg
REGEX = msg=.+Message:\s(?<message>.+).+sev=5

[subsystem]
# Subsystem from message
SOURCE_KEY = msg
REGEX = msg=.+Subsystem:\s+(?<subsystem>[\w\s]+),.+

[user]
# Username from msg
SOURCE_KEY = msg
REGEX = msg=Username:\s+(?<user>\w+),.*

[account]
# modified account from the message
SOURCE_KEY = message
REGEX = .*for\suser:?\s'?(?<account>[\w_-]+)('?|\.?).*

[modification]
# modification information from the message
SOURCE_KEY = message
REGEX = .*account.*was\s(?<modification>[a-z]+)((\sfor\suser.+)?|(\.)?)

[pg_and_traffic]
# protection group name and traffic information (volume, value)
SOURCE_KEY = msg
REGEX = msg=.+raffic.+'(?<pg_name>[\w\s\-]+)'.+\s(?<traffic_volume>\d+\.\d+)\s*(?<traffic_value>[a-zA-z]{2}ps)\.\s.+

[license_and_traffic]
# protection group name and traffic information (volume, value)
SOURCE_KEY = msg
REGEX = msg=.+license\slimit.+\s(?<traffic_volume>\d+\.\d+)\s*(?<traffic_value>[a-zA-z]{2}ps)\.\s.+
